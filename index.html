<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proto API Documentation</title>
    
    <!-- Force canonical URL -->
    <link rel="canonical" href="https://proto-sdk.github.io/proto-api-docs/">
    <meta property="og:url" content="https://proto-sdk.github.io/proto-api-docs/">
    
    <!-- Prevent any custom domain caching -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    
    <link rel="stylesheet" href="https://unpkg.com/swagger-ui-dist@5.9.0/swagger-ui.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header class="header">
        <h1>Proto API Documentation</h1>
        <p>Complete Control and Monitoring Interface for Professional Mining Operations</p>
        <span class="version">v1.4.0</span>
    </header>

    <main class="main-content">
        <section class="features">
            <div class="feature-card">
                <h3>Mining Control</h3>
                <p>Start, stop, and configure mining operations with precise power target control.</p>
            </div>
            <div class="feature-card">
                <h3>Real-time Monitoring</h3>
                <p>Track hashrate, temperature, and power consumption across all hashboards.</p>
            </div>
            <div class="feature-card">
                <h3>Pool Management</h3>
                <p>Configure and manage multiple mining pools with automatic failover support.</p>
            </div>
        </section>

        <section class="api-docs">
            <div id="swagger-ui"></div>
        </section>
    </main>

    <footer>
        <p>Contact: mining.support@block.xyz</p>
    </footer>

    <script src="https://unpkg.com/swagger-ui-dist@5.9.0/swagger-ui-bundle.js"></script>
    <script src="https://unpkg.com/swagger-ui-dist@5.9.0/swagger-ui-standalone-preset.js"></script>
    <script>
        window.onload = function() {
            console.log('Loading Swagger UI...');
            
            // Fetch the spec first to ensure it loads
            fetch('spec.json')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Failed to load spec.json');
                    }
                    return response.json();
                })
                .then(spec => {
                    console.log('Spec loaded, initializing Swagger UI...');
                    
                    const ui = SwaggerUIBundle({
                        spec: spec,
                        dom_id: '#swagger-ui',
                        deepLinking: true,
                        presets: [
                            SwaggerUIBundle.presets.apis,
                            SwaggerUIBundle.SwaggerUIStandalonePreset
                        ],
                        layout: "BaseLayout",
                        docExpansion: "list",
                        defaultModelsExpandDepth: 2,
                        defaultModelExpandDepth: 2,
                        displayRequestDuration: true,
                        tryItOutEnabled: true,
                        filter: true,
                        persistAuthorization: true,
                        showCommonExtensions: true,
                        showExtensions: true
                    });
                    
                    window.ui = ui;
                    console.log('Swagger UI initialized');
                })
                .catch(error => {
                    console.error('Error loading API documentation:', error);
                    document.getElementById('swagger-ui').innerHTML = 
                        '<div style="color: red; padding: 20px;">Error loading API documentation: ' + error.message + '</div>';
                });
        };
    </script>
</body>
</html>
